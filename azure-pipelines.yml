trigger:
- master

pool:
  vmImage: 'ubuntu-latest'
strategy:
  matrix:
    Python38:
      python.version: '3.7'
steps:
- script: git submodule update --init --recursive
  displayName: Init submodules

- bash: echo "##vso[task.prependpath]$CONDA/bin"
  displayName: Add conda to PATH

- script: | 
    conda config --set always_yes yes --set anaconda_upload no
    conda update -q conda
    conda create -n test python=$(python.version) conda-build conda-verify
  displayName: '[Conda] Create environment Python $(python.version)'

- script: |
    source activate test
    conda build .
  displayName: '[Conda] Build'